{"ast":null,"code":"// Load modules\n\nvar Crypto = require('crypto');\nvar Boom = require('boom');\n\n// Declare internals\n\nvar internals = {};\n\n// Generate a cryptographically strong pseudo-random data\n\nexports.randomString = function (size) {\n  var buffer = exports.randomBits((size + 1) * 6);\n  if (buffer instanceof Error) {\n    return buffer;\n  }\n  var string = buffer.toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n  return string.slice(0, size);\n};\nexports.randomBits = function (bits) {\n  if (!bits || bits < 0) {\n    return Boom.internal('Invalid random bits count');\n  }\n  var bytes = Math.ceil(bits / 8);\n  try {\n    return Crypto.randomBytes(bytes);\n  } catch (err) {\n    return Boom.internal('Failed generating random bits: ' + err.message);\n  }\n};\n\n// Compare two strings using fixed time algorithm (to prevent time-based analysis of MAC digest match)\n\nexports.fixedTimeComparison = function (a, b) {\n  if (typeof a !== 'string' || typeof b !== 'string') {\n    return false;\n  }\n  var mismatch = a.length === b.length ? 0 : 1;\n  if (mismatch) {\n    b = a;\n  }\n  for (var i = 0, il = a.length; i < il; ++i) {\n    var ac = a.charCodeAt(i);\n    var bc = b.charCodeAt(i);\n    mismatch += ac === bc ? 0 : 1;\n  }\n  return mismatch === 0;\n};","map":{"version":3,"names":["Crypto","require","Boom","internals","exports","randomString","size","buffer","randomBits","Error","string","toString","replace","slice","bits","internal","bytes","Math","ceil","randomBytes","err","message","fixedTimeComparison","a","b","mismatch","length","i","il","ac","charCodeAt","bc"],"sources":["/Users/jaraga/CodeOp/perthesclinica/node_modules/cryptiles/lib/index.js"],"sourcesContent":["// Load modules\n\nvar Crypto = require('crypto');\nvar Boom = require('boom');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Generate a cryptographically strong pseudo-random data\n\nexports.randomString = function (size) {\n\n    var buffer = exports.randomBits((size + 1) * 6);\n    if (buffer instanceof Error) {\n        return buffer;\n    }\n\n    var string = buffer.toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n    return string.slice(0, size);\n};\n\n\nexports.randomBits = function (bits) {\n\n    if (!bits ||\n        bits < 0) {\n\n        return Boom.internal('Invalid random bits count');\n    }\n\n    var bytes = Math.ceil(bits / 8);\n    try {\n        return Crypto.randomBytes(bytes);\n    }\n    catch (err) {\n        return Boom.internal('Failed generating random bits: ' + err.message);\n    }\n};\n\n\n// Compare two strings using fixed time algorithm (to prevent time-based analysis of MAC digest match)\n\nexports.fixedTimeComparison = function (a, b) {\n\n    if (typeof a !== 'string' ||\n        typeof b !== 'string') {\n\n        return false;\n    }\n\n    var mismatch = (a.length === b.length ? 0 : 1);\n    if (mismatch) {\n        b = a;\n    }\n\n    for (var i = 0, il = a.length; i < il; ++i) {\n        var ac = a.charCodeAt(i);\n        var bc = b.charCodeAt(i);\n        mismatch += (ac === bc ? 0 : 1);\n    }\n\n    return (mismatch === 0);\n};\n\n\n"],"mappings":"AAAA;;AAEA,IAAIA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAC9B,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;;AAG1B;;AAEA,IAAIE,SAAS,GAAG,CAAC,CAAC;;AAGlB;;AAEAC,OAAO,CAACC,YAAY,GAAG,UAAUC,IAAI,EAAE;EAEnC,IAAIC,MAAM,GAAGH,OAAO,CAACI,UAAU,CAAC,CAACF,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC;EAC/C,IAAIC,MAAM,YAAYE,KAAK,EAAE;IACzB,OAAOF,MAAM;EACjB;EAEA,IAAIG,MAAM,GAAGH,MAAM,CAACI,QAAQ,CAAC,QAAQ,CAAC,CAACC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;EACjG,OAAOF,MAAM,CAACG,KAAK,CAAC,CAAC,EAAEP,IAAI,CAAC;AAChC,CAAC;AAGDF,OAAO,CAACI,UAAU,GAAG,UAAUM,IAAI,EAAE;EAEjC,IAAI,CAACA,IAAI,IACLA,IAAI,GAAG,CAAC,EAAE;IAEV,OAAOZ,IAAI,CAACa,QAAQ,CAAC,2BAA2B,CAAC;EACrD;EAEA,IAAIC,KAAK,GAAGC,IAAI,CAACC,IAAI,CAACJ,IAAI,GAAG,CAAC,CAAC;EAC/B,IAAI;IACA,OAAOd,MAAM,CAACmB,WAAW,CAACH,KAAK,CAAC;EACpC,CAAC,CACD,OAAOI,GAAG,EAAE;IACR,OAAOlB,IAAI,CAACa,QAAQ,CAAC,iCAAiC,GAAGK,GAAG,CAACC,OAAO,CAAC;EACzE;AACJ,CAAC;;AAGD;;AAEAjB,OAAO,CAACkB,mBAAmB,GAAG,UAAUC,CAAC,EAAEC,CAAC,EAAE;EAE1C,IAAI,OAAOD,CAAC,KAAK,QAAQ,IACrB,OAAOC,CAAC,KAAK,QAAQ,EAAE;IAEvB,OAAO,KAAK;EAChB;EAEA,IAAIC,QAAQ,GAAIF,CAAC,CAACG,MAAM,KAAKF,CAAC,CAACE,MAAM,GAAG,CAAC,GAAG,CAAE;EAC9C,IAAID,QAAQ,EAAE;IACVD,CAAC,GAAGD,CAAC;EACT;EAEA,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEC,EAAE,GAAGL,CAAC,CAACG,MAAM,EAAEC,CAAC,GAAGC,EAAE,EAAE,EAAED,CAAC,EAAE;IACxC,IAAIE,EAAE,GAAGN,CAAC,CAACO,UAAU,CAACH,CAAC,CAAC;IACxB,IAAII,EAAE,GAAGP,CAAC,CAACM,UAAU,CAACH,CAAC,CAAC;IACxBF,QAAQ,IAAKI,EAAE,KAAKE,EAAE,GAAG,CAAC,GAAG,CAAE;EACnC;EAEA,OAAQN,QAAQ,KAAK,CAAC;AAC1B,CAAC"},"metadata":{},"sourceType":"script"}