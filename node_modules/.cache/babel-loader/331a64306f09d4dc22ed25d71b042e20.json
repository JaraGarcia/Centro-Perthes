{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nvar util = require('util');\nvar Stream = require('stream').Stream;\nvar DelayedStream = require('delayed-stream');\nmodule.exports = CombinedStream;\nfunction CombinedStream() {\n  this.writable = false;\n  this.readable = true;\n  this.dataSize = 0;\n  this.maxDataSize = 2 * 1024 * 1024;\n  this.pauseStreams = true;\n  this._released = false;\n  this._streams = [];\n  this._currentStream = null;\n}\nutil.inherits(CombinedStream, Stream);\nCombinedStream.create = function (options) {\n  var combinedStream = new this();\n  options = options || {};\n  for (var option in options) {\n    combinedStream[option] = options[option];\n  }\n  return combinedStream;\n};\nCombinedStream.isStreamLike = function (stream) {\n  return typeof stream !== 'function' && typeof stream !== 'string' && typeof stream !== 'boolean' && typeof stream !== 'number' && !Buffer.isBuffer(stream);\n};\nCombinedStream.prototype.append = function (stream) {\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    if (!(stream instanceof DelayedStream)) {\n      var newStream = DelayedStream.create(stream, {\n        maxDataSize: Infinity,\n        pauseStream: this.pauseStreams\n      });\n      stream.on('data', this._checkDataSize.bind(this));\n      stream = newStream;\n    }\n    this._handleErrors(stream);\n    if (this.pauseStreams) {\n      stream.pause();\n    }\n  }\n  this._streams.push(stream);\n  return this;\n};\nCombinedStream.prototype.pipe = function (dest, options) {\n  Stream.prototype.pipe.call(this, dest, options);\n  this.resume();\n  return dest;\n};\nCombinedStream.prototype._getNext = function () {\n  this._currentStream = null;\n  var stream = this._streams.shift();\n  if (typeof stream == 'undefined') {\n    this.end();\n    return;\n  }\n  if (typeof stream !== 'function') {\n    this._pipeNext(stream);\n    return;\n  }\n  var getStream = stream;\n  getStream(function (stream) {\n    var isStreamLike = CombinedStream.isStreamLike(stream);\n    if (isStreamLike) {\n      stream.on('data', this._checkDataSize.bind(this));\n      this._handleErrors(stream);\n    }\n    this._pipeNext(stream);\n  }.bind(this));\n};\nCombinedStream.prototype._pipeNext = function (stream) {\n  this._currentStream = stream;\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    stream.on('end', this._getNext.bind(this));\n    stream.pipe(this, {\n      end: false\n    });\n    return;\n  }\n  var value = stream;\n  this.write(value);\n  this._getNext();\n};\nCombinedStream.prototype._handleErrors = function (stream) {\n  var self = this;\n  stream.on('error', function (err) {\n    self._emitError(err);\n  });\n};\nCombinedStream.prototype.write = function (data) {\n  this.emit('data', data);\n};\nCombinedStream.prototype.pause = function () {\n  if (!this.pauseStreams) {\n    return;\n  }\n  if (this.pauseStreams && this._currentStream && typeof this._currentStream.pause == 'function') this._currentStream.pause();\n  this.emit('pause');\n};\nCombinedStream.prototype.resume = function () {\n  if (!this._released) {\n    this._released = true;\n    this.writable = true;\n    this._getNext();\n  }\n  if (this.pauseStreams && this._currentStream && typeof this._currentStream.resume == 'function') this._currentStream.resume();\n  this.emit('resume');\n};\nCombinedStream.prototype.end = function () {\n  this._reset();\n  this.emit('end');\n};\nCombinedStream.prototype.destroy = function () {\n  this._reset();\n  this.emit('close');\n};\nCombinedStream.prototype._reset = function () {\n  this.writable = false;\n  this._streams = [];\n  this._currentStream = null;\n};\nCombinedStream.prototype._checkDataSize = function () {\n  this._updateDataSize();\n  if (this.dataSize <= this.maxDataSize) {\n    return;\n  }\n  var message = 'DelayedStream#maxDataSize of ' + this.maxDataSize + ' bytes exceeded.';\n  this._emitError(new Error(message));\n};\nCombinedStream.prototype._updateDataSize = function () {\n  this.dataSize = 0;\n  var self = this;\n  this._streams.forEach(function (stream) {\n    if (!stream.dataSize) {\n      return;\n    }\n    self.dataSize += stream.dataSize;\n  });\n  if (this._currentStream && this._currentStream.dataSize) {\n    this.dataSize += this._currentStream.dataSize;\n  }\n};\nCombinedStream.prototype._emitError = function (err) {\n  this._reset();\n  this.emit('error', err);\n};","map":{"version":3,"names":["util","require","Stream","DelayedStream","module","exports","CombinedStream","writable","readable","dataSize","maxDataSize","pauseStreams","_released","_streams","_currentStream","inherits","create","options","combinedStream","option","isStreamLike","stream","Buffer","isBuffer","prototype","append","newStream","Infinity","pauseStream","on","_checkDataSize","bind","_handleErrors","pause","push","pipe","dest","call","resume","_getNext","shift","end","_pipeNext","getStream","value","write","self","err","_emitError","data","emit","_reset","destroy","_updateDataSize","message","Error","forEach"],"sources":["/Users/jaraga/CodeOp/perthesclinica/node_modules/combined-stream/lib/combined_stream.js"],"sourcesContent":["var util = require('util');\nvar Stream = require('stream').Stream;\nvar DelayedStream = require('delayed-stream');\n\nmodule.exports = CombinedStream;\nfunction CombinedStream() {\n  this.writable = false;\n  this.readable = true;\n  this.dataSize = 0;\n  this.maxDataSize = 2 * 1024 * 1024;\n  this.pauseStreams = true;\n\n  this._released = false;\n  this._streams = [];\n  this._currentStream = null;\n}\nutil.inherits(CombinedStream, Stream);\n\nCombinedStream.create = function(options) {\n  var combinedStream = new this();\n\n  options = options || {};\n  for (var option in options) {\n    combinedStream[option] = options[option];\n  }\n\n  return combinedStream;\n};\n\nCombinedStream.isStreamLike = function(stream) {\n  return (typeof stream !== 'function')\n    && (typeof stream !== 'string')\n    && (typeof stream !== 'boolean')\n    && (typeof stream !== 'number')\n    && (!Buffer.isBuffer(stream));\n};\n\nCombinedStream.prototype.append = function(stream) {\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n\n  if (isStreamLike) {\n    if (!(stream instanceof DelayedStream)) {\n      var newStream = DelayedStream.create(stream, {\n        maxDataSize: Infinity,\n        pauseStream: this.pauseStreams,\n      });\n      stream.on('data', this._checkDataSize.bind(this));\n      stream = newStream;\n    }\n\n    this._handleErrors(stream);\n\n    if (this.pauseStreams) {\n      stream.pause();\n    }\n  }\n\n  this._streams.push(stream);\n  return this;\n};\n\nCombinedStream.prototype.pipe = function(dest, options) {\n  Stream.prototype.pipe.call(this, dest, options);\n  this.resume();\n  return dest;\n};\n\nCombinedStream.prototype._getNext = function() {\n  this._currentStream = null;\n  var stream = this._streams.shift();\n\n\n  if (typeof stream == 'undefined') {\n    this.end();\n    return;\n  }\n\n  if (typeof stream !== 'function') {\n    this._pipeNext(stream);\n    return;\n  }\n\n  var getStream = stream;\n  getStream(function(stream) {\n    var isStreamLike = CombinedStream.isStreamLike(stream);\n    if (isStreamLike) {\n      stream.on('data', this._checkDataSize.bind(this));\n      this._handleErrors(stream);\n    }\n\n    this._pipeNext(stream);\n  }.bind(this));\n};\n\nCombinedStream.prototype._pipeNext = function(stream) {\n  this._currentStream = stream;\n\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    stream.on('end', this._getNext.bind(this));\n    stream.pipe(this, {end: false});\n    return;\n  }\n\n  var value = stream;\n  this.write(value);\n  this._getNext();\n};\n\nCombinedStream.prototype._handleErrors = function(stream) {\n  var self = this;\n  stream.on('error', function(err) {\n    self._emitError(err);\n  });\n};\n\nCombinedStream.prototype.write = function(data) {\n  this.emit('data', data);\n};\n\nCombinedStream.prototype.pause = function() {\n  if (!this.pauseStreams) {\n    return;\n  }\n\n  if(this.pauseStreams && this._currentStream && typeof(this._currentStream.pause) == 'function') this._currentStream.pause();\n  this.emit('pause');\n};\n\nCombinedStream.prototype.resume = function() {\n  if (!this._released) {\n    this._released = true;\n    this.writable = true;\n    this._getNext();\n  }\n\n  if(this.pauseStreams && this._currentStream && typeof(this._currentStream.resume) == 'function') this._currentStream.resume();\n  this.emit('resume');\n};\n\nCombinedStream.prototype.end = function() {\n  this._reset();\n  this.emit('end');\n};\n\nCombinedStream.prototype.destroy = function() {\n  this._reset();\n  this.emit('close');\n};\n\nCombinedStream.prototype._reset = function() {\n  this.writable = false;\n  this._streams = [];\n  this._currentStream = null;\n};\n\nCombinedStream.prototype._checkDataSize = function() {\n  this._updateDataSize();\n  if (this.dataSize <= this.maxDataSize) {\n    return;\n  }\n\n  var message =\n    'DelayedStream#maxDataSize of ' + this.maxDataSize + ' bytes exceeded.';\n  this._emitError(new Error(message));\n};\n\nCombinedStream.prototype._updateDataSize = function() {\n  this.dataSize = 0;\n\n  var self = this;\n  this._streams.forEach(function(stream) {\n    if (!stream.dataSize) {\n      return;\n    }\n\n    self.dataSize += stream.dataSize;\n  });\n\n  if (this._currentStream && this._currentStream.dataSize) {\n    this.dataSize += this._currentStream.dataSize;\n  }\n};\n\nCombinedStream.prototype._emitError = function(err) {\n  this._reset();\n  this.emit('error', err);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}