{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nvar http = require('http'),\n  https = false,\n  tls = false,\n  url = require('url'),\n  util = require('util'),\n  stream = require('stream'),\n  qs = require('qs'),\n  querystring = require('querystring'),\n  crypto = require('crypto'),\n  oauth = require('oauth-sign'),\n  hawk = require('hawk'),\n  aws = require('aws-sign'),\n  httpSignature = require('http-signature'),\n  uuid = require('node-uuid'),\n  mime = require('mime'),\n  tunnel = require('tunnel-agent'),\n  _safeStringify = require('json-stringify-safe'),\n  ForeverAgent = require('forever-agent'),\n  FormData = require('form-data'),\n  Cookie = require('cookie-jar'),\n  CookieJar = Cookie.Jar,\n  cookieJar = new CookieJar(),\n  copy = require('./lib/copy'),\n  debug = require('./lib/debug'),\n  getSafe = require('./lib/getSafe');\nfunction safeStringify(obj) {\n  var ret;\n  try {\n    ret = JSON.stringify(obj);\n  } catch (e) {\n    ret = _safeStringify(obj);\n  }\n  return ret;\n}\nvar globalPool = {};\nvar isUrl = /^https?:/i;\ntry {\n  https = require('https');\n} catch (e) {}\ntry {\n  tls = require('tls');\n} catch (e) {}\n\n// Hacky fix for pre-0.4.4 https\nif (https && !https.Agent) {\n  https.Agent = function (options) {\n    http.Agent.call(this, options);\n  };\n  util.inherits(https.Agent, http.Agent);\n  https.Agent.prototype._getConnection = function (host, port, cb) {\n    var s = tls.connect(port, host, this.options, function () {\n      // do other checks here?\n      if (cb) cb();\n    });\n    return s;\n  };\n}\nfunction isReadStream(rs) {\n  if (rs.readable && rs.path && rs.mode) {\n    return true;\n  }\n}\nfunction toBase64(str) {\n  return new Buffer(str || \"\", \"ascii\").toString(\"base64\");\n}\nfunction md5(str) {\n  return crypto.createHash('md5').update(str).digest('hex');\n}\nfunction Request(options) {\n  stream.Stream.call(this);\n  this.readable = true;\n  this.writable = true;\n  if (typeof options === 'string') {\n    options = {\n      uri: options\n    };\n  }\n  var reserved = Object.keys(Request.prototype);\n  for (var i in options) {\n    if (reserved.indexOf(i) === -1) {\n      this[i] = options[i];\n    } else {\n      if (typeof options[i] === 'function') {\n        delete options[i];\n      }\n    }\n  }\n  if (options.method) {\n    this.explicitMethod = true;\n  }\n  this.init(options);\n}\nutil.inherits(Request, stream.Stream);\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this;\n  if (!options) options = {};\n  if (!self.method) self.method = options.method || 'GET';\n  self.localAddress = options.localAddress;\n  debug(options);\n  if (!self.pool && self.pool !== false) self.pool = globalPool;\n  self.dests = self.dests || [];\n  self.__isRequestRequest = true;\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback;\n    self.callback = function () {\n      if (self._callbackCalled) return; // Print a warning maybe?\n      self._callbackCalled = true;\n      self._callback.apply(self, arguments);\n    };\n    self.on('error', self.callback.bind());\n    self.on('complete', self.callback.bind(self, null));\n  }\n  if (self.url && !self.uri) {\n    // People use this property instead all the time so why not just support it.\n    self.uri = self.url;\n    delete self.url;\n  }\n  if (!self.uri) {\n    // this will throw if unhandled but is handleable when in a redirect\n    return self.emit('error', new Error(\"options.uri is a required argument\"));\n  } else {\n    if (typeof self.uri == \"string\") self.uri = url.parse(self.uri);\n  }\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false;\n  }\n  if (self.proxy) {\n    if (typeof self.proxy == 'string') self.proxy = url.parse(self.proxy);\n\n    // do the HTTP CONNECT dance using koichik/node-tunnel\n    if (http.globalAgent && self.uri.protocol === \"https:\") {\n      var tunnelFn = self.proxy.protocol === \"http:\" ? tunnel.httpsOverHttp : tunnel.httpsOverHttps;\n      var tunnelOptions = {\n        proxy: {\n          host: self.proxy.hostname,\n          port: +self.proxy.port,\n          proxyAuth: self.proxy.auth,\n          headers: {\n            Host: self.uri.hostname + ':' + (self.uri.port || self.uri.protocol === 'https:' ? 443 : 80)\n          }\n        },\n        rejectUnauthorized: self.rejectUnauthorized,\n        ca: this.ca\n      };\n      self.agent = tunnelFn(tunnelOptions);\n      self.tunnel = true;\n    }\n  }\n  if (!self.uri.pathname) {\n    self.uri.pathname = '/';\n  }\n  if (!self.uri.host) {\n    // Invalid URI: it may generate lot of bad errors, like \"TypeError: Cannot call method 'indexOf' of undefined\" in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri);\n    var message = 'Invalid URI \"' + faultyUri + '\"';\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (he didn't call request directly with this URL)\n      // he should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.';\n    }\n    self.emit('error', new Error(message));\n    return; // This error was fatal\n  }\n\n  self._redirectsFollowed = self._redirectsFollowed || 0;\n  self.maxRedirects = self.maxRedirects !== undefined ? self.maxRedirects : 10;\n  self.followRedirect = self.followRedirect !== undefined ? self.followRedirect : true;\n  self.followAllRedirects = self.followAllRedirects !== undefined ? self.followAllRedirects : false;\n  if (self.followRedirect || self.followAllRedirects) self.redirects = self.redirects || [];\n  self.headers = self.headers ? copy(self.headers) : {};\n  self.setHost = false;\n  if (!self.hasHeader('host')) {\n    self.setHeader('host', self.uri.hostname);\n    if (self.uri.port) {\n      if (!(self.uri.port === 80 && self.uri.protocol === 'http:') && !(self.uri.port === 443 && self.uri.protocol === 'https:')) self.setHeader('host', self.getHeader('host') + (':' + self.uri.port));\n    }\n    self.setHost = true;\n  }\n  self.jar(self._jar || options.jar);\n  if (!self.uri.port) {\n    if (self.uri.protocol == 'http:') {\n      self.uri.port = 80;\n    } else if (self.uri.protocol == 'https:') {\n      self.uri.port = 443;\n    }\n  }\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port;\n    self.host = self.proxy.hostname;\n  } else {\n    self.port = self.uri.port;\n    self.host = self.uri.hostname;\n  }\n  self.clientErrorHandler = function (error) {\n    if (self._aborted) return;\n    if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET' && self.agent.addRequestNoreuse) {\n      self.agent = {\n        addRequest: self.agent.addRequestNoreuse.bind(self.agent)\n      };\n      self.start();\n      self.req.end();\n      return;\n    }\n    if (self.timeout && self.timeoutTimer) {\n      clearTimeout(self.timeoutTimer);\n      self.timeoutTimer = null;\n    }\n    self.emit('error', error);\n  };\n  self._parserErrorHandler = function (error) {\n    if (this.res) {\n      if (this.res.request) {\n        this.res.request.emit('error', error);\n      } else {\n        this.res.emit('error', error);\n      }\n    } else {\n      this._httpMessage.emit('error', error);\n    }\n  };\n  if (options.form) {\n    self.form(options.form);\n  }\n  if (options.qs) self.qs(options.qs);\n  if (self.uri.path) {\n    self.path = self.uri.path;\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || \"\");\n  }\n  if (self.path.length === 0) self.path = '/';\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.oauth) {\n    self.oauth(options.oauth);\n  }\n  if (options.aws) {\n    self.aws(options.aws);\n  }\n  if (options.hawk) {\n    self.hawk(options.hawk);\n  }\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature);\n  }\n  if (options.auth) {\n    self.auth(options.auth.user === \"\" ? options.auth.user : options.auth.user || options.auth.username, options.auth.pass || options.auth.password, options.auth.sendImmediately);\n  }\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var authPieces = self.uri.auth.split(':').map(function (item) {\n      return querystring.unescape(item);\n    });\n    self.auth(authPieces[0], authPieces.slice(1).join(':'), true);\n  }\n  if (self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization') && !self.tunnel) {\n    self.setHeader('proxy-authorization', \"Basic \" + toBase64(self.proxy.auth.split(':').map(function (item) {\n      return querystring.unescape(item);\n    }).join(':')));\n  }\n  if (self.proxy && !self.tunnel) self.path = self.uri.protocol + '//' + self.uri.host + self.path;\n  if (options.json) {\n    self.json(options.json);\n  } else if (options.multipart) {\n    self.boundary = uuid();\n    self.multipart(options.multipart);\n  }\n  if (self.body) {\n    var length = 0;\n    if (!Buffer.isBuffer(self.body)) {\n      if (Array.isArray(self.body)) {\n        for (var i = 0; i < self.body.length; i++) {\n          length += self.body[i].length;\n        }\n      } else {\n        self.body = new Buffer(self.body);\n        length = self.body.length;\n      }\n    } else {\n      length = self.body.length;\n    }\n    if (length) {\n      if (!self.hasHeader('content-length')) self.setHeader('content-length', length);\n    } else {\n      throw new Error('Argument error, options.body.');\n    }\n  }\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol,\n    defaultModules = {\n      'http:': http,\n      'https:': https\n    },\n    httpModules = self.httpModules || {};\n  self.httpModule = httpModules[protocol] || defaultModules[protocol];\n  if (!self.httpModule) return this.emit('error', new Error(\"Invalid protocol\"));\n  if (options.ca) self.ca = options.ca;\n  if (!self.agent) {\n    if (options.agentOptions) self.agentOptions = options.agentOptions;\n    if (options.agentClass) {\n      self.agentClass = options.agentClass;\n    } else if (options.forever) {\n      self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL;\n    } else {\n      self.agentClass = self.httpModule.Agent;\n    }\n  }\n  if (self.pool === false) {\n    self.agent = false;\n  } else {\n    self.agent = self.agent || self.getAgent();\n    if (self.maxSockets) {\n      // Don't use our pooling if node has the refactored client\n      self.agent.maxSockets = self.maxSockets;\n    }\n    if (self.pool.maxSockets) {\n      // Don't use our pooling if node has the refactored client\n      self.agent.maxSockets = self.pool.maxSockets;\n    }\n  }\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) throw new Error(\"You cannot pipe to this stream after the outbound request has started.\");\n    self.src = src;\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) self.setHeader('content-type', mime.lookup(src.path));\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i]);\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) self.setHeader('content-type', 'application/json');\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method;\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error(\"You have already piped to this stream. Pipeing twice is likely to break the request.\")\n    // })\n  });\n\n  process.nextTick(function () {\n    if (self._aborted) return;\n    if (self._form) {\n      self.setHeaders(self._form.getHeaders());\n      self._form.pipe(self);\n    }\n    if (self.body) {\n      if (Array.isArray(self.body)) {\n        self.body.forEach(function (part) {\n          self.write(part);\n        });\n      } else {\n        self.write(self.body);\n      }\n      self.end();\n    } else if (self.requestBodyStream) {\n      console.warn(\"options.requestBodyStream is deprecated, please pass the request object to stream.pipe.\");\n      self.requestBodyStream.pipe(self);\n    } else if (!self.src) {\n      if (self.method !== 'GET' && typeof self.method !== 'undefined') {\n        self.setHeader('content-length', 0);\n      }\n      self.end();\n    }\n    self.ntick = true;\n  });\n};\n\n// Must call this when following a redirect from https to http or vice versa\n// Attempts to keep everything as identical as possible, but update the\n// httpModule, Tunneling agent, and/or Forever Agent in use.\nRequest.prototype._updateProtocol = function () {\n  var self = this;\n  var protocol = self.uri.protocol;\n  if (protocol === 'https:') {\n    // previously was doing http, now doing https\n    // if it's https, then we might need to tunnel now.\n    if (self.proxy) {\n      self.tunnel = true;\n      var tunnelFn = self.proxy.protocol === 'http:' ? tunnel.httpsOverHttp : tunnel.httpsOverHttps;\n      var tunnelOptions = {\n        proxy: {\n          host: self.proxy.hostname,\n          port: +self.proxy.port,\n          proxyAuth: self.proxy.auth\n        },\n        rejectUnauthorized: self.rejectUnauthorized,\n        ca: self.ca\n      };\n      self.agent = tunnelFn(tunnelOptions);\n      return;\n    }\n    self.httpModule = https;\n    switch (self.agentClass) {\n      case ForeverAgent:\n        self.agentClass = ForeverAgent.SSL;\n        break;\n      case http.Agent:\n        self.agentClass = https.Agent;\n        break;\n      default:\n        // nothing we can do.  Just hope for the best.\n        return;\n    }\n\n    // if there's an agent, we need to get a new one.\n    if (self.agent) self.agent = self.getAgent();\n  } else {\n    // previously was doing https, now doing http\n    // stop any tunneling.\n    if (self.tunnel) self.tunnel = false;\n    self.httpModule = http;\n    switch (self.agentClass) {\n      case ForeverAgent.SSL:\n        self.agentClass = ForeverAgent;\n        break;\n      case https.Agent:\n        self.agentClass = http.Agent;\n        break;\n      default:\n        // nothing we can do.  just hope for the best\n        return;\n    }\n\n    // if there's an agent, then get a new one.\n    if (self.agent) {\n      self.agent = null;\n      self.agent = self.getAgent();\n    }\n  }\n};\nRequest.prototype.getAgent = function () {\n  var Agent = this.agentClass;\n  var options = {};\n  if (this.agentOptions) {\n    for (var i in this.agentOptions) {\n      options[i] = this.agentOptions[i];\n    }\n  }\n  if (this.ca) options.ca = this.ca;\n  if (typeof this.rejectUnauthorized !== 'undefined') options.rejectUnauthorized = this.rejectUnauthorized;\n  if (this.cert && this.key) {\n    options.key = this.key;\n    options.cert = this.cert;\n  }\n  var poolKey = '';\n\n  // different types of agents are in different pools\n  if (Agent !== this.httpModule.Agent) {\n    poolKey += Agent.name;\n  }\n  if (!this.httpModule.globalAgent) {\n    // node 0.4.x\n    options.host = this.host;\n    options.port = this.port;\n    if (poolKey) poolKey += ':';\n    poolKey += this.host + ':' + this.port;\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = this.proxy;\n  if (typeof proxy === 'string') proxy = url.parse(proxy);\n  var isHttps = proxy && proxy.protocol === 'https:' || this.uri.protocol === 'https:';\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) poolKey += ':';\n      poolKey += options.ca;\n    }\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) poolKey += ':';\n      poolKey += options.rejectUnauthorized;\n    }\n    if (options.cert) poolKey += options.cert.toString('ascii') + options.key.toString('ascii');\n    if (options.ciphers) {\n      if (poolKey) poolKey += ':';\n      poolKey += options.ciphers;\n    }\n    if (options.secureOptions) {\n      if (poolKey) poolKey += ':';\n      poolKey += options.secureOptions;\n    }\n  }\n  if (this.pool === globalPool && !poolKey && Object.keys(options).length === 0 && this.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return this.httpModule.globalAgent;\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = this.uri.protocol + poolKey;\n\n  // already generated an agent for this setting\n  if (this.pool[poolKey]) return this.pool[poolKey];\n  return this.pool[poolKey] = new Agent(options);\n};\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this;\n  if (self._aborted) return;\n  self._started = true;\n  self.method = self.method || 'GET';\n  self.href = self.uri.href;\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('content-length', self.src.stat.size);\n  }\n  if (self._aws) {\n    self.aws(self._aws, true);\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self);\n  delete reqOptions.auth;\n  debug('make request', self.uri.href);\n  self.req = self.httpModule.request(reqOptions, self.onResponse.bind(self));\n  if (self.timeout && !self.timeoutTimer) {\n    self.timeoutTimer = setTimeout(function () {\n      self.req.abort();\n      var e = new Error(\"ETIMEDOUT\");\n      e.code = \"ETIMEDOUT\";\n      self.emit(\"error\", e);\n    }, self.timeout);\n\n    // Set additional timeout on socket - in case if remote\n    // server freeze after sending headers\n    if (self.req.setTimeout) {\n      // only works on node 0.6+\n      self.req.setTimeout(self.timeout, function () {\n        if (self.req) {\n          self.req.abort();\n          var e = new Error(\"ESOCKETTIMEDOUT\");\n          e.code = \"ESOCKETTIMEDOUT\";\n          self.emit(\"error\", e);\n        }\n      });\n    }\n  }\n  self.req.on('error', self.clientErrorHandler);\n  self.req.on('drain', function () {\n    self.emit('drain');\n  });\n  self.on('end', function () {\n    if (self.req.connection) self.req.connection.removeListener('error', self._parserErrorHandler);\n  });\n  self.emit('request', self.req);\n};\nRequest.prototype.onResponse = function (response) {\n  var self = this;\n  debug('onResponse', self.uri.href, response.statusCode, response.headers);\n  response.on('end', function () {\n    debug('response end', self.uri.href, response.statusCode, response.headers);\n  });\n  if (response.connection.listeners('error').indexOf(self._parserErrorHandler) === -1) {\n    response.connection.once('error', self._parserErrorHandler);\n  }\n  if (self._aborted) {\n    debug('aborted', self.uri.href);\n    response.resume();\n    return;\n  }\n  if (self._paused) response.pause();else response.resume();\n  self.response = response;\n  response.request = self;\n  response.toJSON = toJSON;\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https && self.strictSSL && !response.client.authorized) {\n    debug('strict ssl error', self.uri.href);\n    var sslErr = response.client.authorizationError;\n    self.emit('error', new Error('SSL Error: ' + sslErr));\n    return;\n  }\n  if (self.setHost && self.hasHeader('host')) delete self.headers[self.hasHeader('host')];\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer);\n    self.timeoutTimer = null;\n  }\n  var addCookie = function (cookie) {\n    if (self._jar) {\n      if (self._jar.add) {\n        self._jar.add(new Cookie(cookie));\n      } else cookieJar.add(new Cookie(cookie));\n    }\n  };\n  if (hasHeader('set-cookie', response.headers) && !self._disableCookies) {\n    var headerName = hasHeader('set-cookie', response.headers);\n    if (Array.isArray(response.headers[headerName])) response.headers[headerName].forEach(addCookie);else addCookie(response.headers[headerName]);\n  }\n  var redirectTo = null;\n  if (response.statusCode >= 300 && response.statusCode < 400 && hasHeader('location', response.headers)) {\n    var location = response.headers[hasHeader('location', response.headers)];\n    debug('redirect', location);\n    if (self.followAllRedirects) {\n      redirectTo = location;\n    } else if (self.followRedirect) {\n      switch (self.method) {\n        case 'PATCH':\n        case 'PUT':\n        case 'POST':\n        case 'DELETE':\n          // Do not follow redirects\n          break;\n        default:\n          redirectTo = location;\n          break;\n      }\n    }\n  } else if (response.statusCode == 401 && self._hasAuth && !self._sentAuth) {\n    var authHeader = response.headers[hasHeader('www-authenticate', response.headers)];\n    var authVerb = authHeader && authHeader.split(' ')[0];\n    debug('reauth', authVerb);\n    switch (authVerb) {\n      case 'Basic':\n        self.auth(self._user, self._pass, true);\n        redirectTo = self.uri;\n        break;\n      case 'Digest':\n        // TODO: More complete implementation of RFC 2617.  For reference:\n        // http://tools.ietf.org/html/rfc2617#section-3\n        // https://github.com/bagder/curl/blob/master/lib/http_digest.c\n\n        var matches = authHeader.match(/([a-z0-9_-]+)=\"([^\"]+)\"/gi);\n        var challenge = {};\n        for (var i = 0; i < matches.length; i++) {\n          var eqPos = matches[i].indexOf('=');\n          var key = matches[i].substring(0, eqPos);\n          var quotedValue = matches[i].substring(eqPos + 1);\n          challenge[key] = quotedValue.substring(1, quotedValue.length - 1);\n        }\n        var ha1 = md5(self._user + ':' + challenge.realm + ':' + self._pass);\n        var ha2 = md5(self.method + ':' + self.uri.path);\n        var digestResponse = md5(ha1 + ':' + challenge.nonce + ':1::auth:' + ha2);\n        var authValues = {\n          username: self._user,\n          realm: challenge.realm,\n          nonce: challenge.nonce,\n          uri: self.uri.path,\n          qop: challenge.qop,\n          response: digestResponse,\n          nc: 1,\n          cnonce: ''\n        };\n        authHeader = [];\n        for (var k in authValues) {\n          authHeader.push(k + '=\"' + authValues[k] + '\"');\n        }\n        authHeader = 'Digest ' + authHeader.join(', ');\n        self.setHeader('authorization', authHeader);\n        self._sentAuth = true;\n        redirectTo = self.uri;\n        break;\n    }\n  }\n  if (redirectTo) {\n    debug('redirect to', redirectTo);\n\n    // ignore any potential response body.  it cannot possibly be useful\n    // to us at this point.\n    if (self._paused) response.resume();\n    if (self._redirectsFollowed >= self.maxRedirects) {\n      self.emit('error', new Error(\"Exceeded maxRedirects. Probably stuck in a redirect loop \" + self.uri.href));\n      return;\n    }\n    self._redirectsFollowed += 1;\n    if (!isUrl.test(redirectTo)) {\n      redirectTo = url.resolve(self.uri.href, redirectTo);\n    }\n    var uriPrev = self.uri;\n    self.uri = url.parse(redirectTo);\n\n    // handle the case where we change protocol from https to http or vice versa\n    if (self.uri.protocol !== uriPrev.protocol) {\n      self._updateProtocol();\n    }\n    self.redirects.push({\n      statusCode: response.statusCode,\n      redirectUri: redirectTo\n    });\n    if (self.followAllRedirects && response.statusCode != 401) self.method = 'GET';\n    // self.method = 'GET' // Force all redirects to use GET || commented out fixes #215\n    delete self.src;\n    delete self.req;\n    delete self.agent;\n    delete self._started;\n    if (response.statusCode != 401) {\n      // Remove parameters from the previous response, unless this is the second request\n      // for a server that requires digest authentication.\n      delete self.body;\n      delete self._form;\n      if (self.headers) {\n        if (self.hasHeader('host')) delete self.headers[self.hasHeader('host')];\n        if (self.hasHeader('content-type')) delete self.headers[self.hasHeader('content-type')];\n        if (self.hasHeader('content-length')) delete self.headers[self.hasHeader('content-length')];\n      }\n    }\n    self.emit('redirect');\n    self.init();\n    return; // Ignore the rest of the response\n  } else {\n    self._redirectsFollowed = self._redirectsFollowed || 0;\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.on('close', function () {\n      if (!self._ended) self.response.emit('end');\n    });\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error(\"Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.\");\n      } else {\n        response.setEncoding(self.encoding);\n      }\n    }\n    self.emit('response', response);\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest);\n    });\n    response.on(\"data\", function (chunk) {\n      self._destdata = true;\n      self.emit(\"data\", chunk);\n    });\n    response.on(\"end\", function (chunk) {\n      self._ended = true;\n      self.emit(\"end\", chunk);\n    });\n    response.on(\"close\", function () {\n      self.emit(\"close\");\n    });\n    if (self.callback) {\n      var buffer = [];\n      var bodyLen = 0;\n      self.on(\"data\", function (chunk) {\n        buffer.push(chunk);\n        bodyLen += chunk.length;\n      });\n      self.on(\"end\", function () {\n        debug('end event', self.uri.href);\n        if (self._aborted) {\n          debug('aborted', self.uri.href);\n          return;\n        }\n        if (buffer.length && Buffer.isBuffer(buffer[0])) {\n          debug('has body', self.uri.href, bodyLen);\n          var body = new Buffer(bodyLen);\n          var i = 0;\n          buffer.forEach(function (chunk) {\n            chunk.copy(body, i, 0, chunk.length);\n            i += chunk.length;\n          });\n          if (self.encoding === null) {\n            response.body = body;\n          } else {\n            response.body = body.toString(self.encoding);\n          }\n        } else if (buffer.length) {\n          // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n          // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n          if (self.encoding === 'utf8' && buffer[0].length > 0 && buffer[0][0] === \"\\uFEFF\") {\n            buffer[0] = buffer[0].substring(1);\n          }\n          response.body = buffer.join('');\n        }\n        if (self._json) {\n          try {\n            response.body = JSON.parse(response.body);\n          } catch (e) {}\n        }\n        debug('emitting complete', self.uri.href);\n        if (response.body == undefined && !self._json) {\n          response.body = \"\";\n        }\n        self.emit('complete', response, response.body);\n      });\n    }\n    //if no callback\n    else {\n      self.on(\"end\", function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href);\n          return;\n        }\n        self.emit('complete', response);\n      });\n    }\n  }\n  debug('finish init function', self.uri.href);\n};\nRequest.prototype.abort = function () {\n  this._aborted = true;\n  if (this.req) {\n    this.req.abort();\n  } else if (this.response) {\n    this.response.abort();\n  }\n  this.emit(\"abort\");\n};\nRequest.prototype.pipeDest = function (dest) {\n  var response = this.response;\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (hasHeader('content-type', response.headers)) {\n      var ctname = hasHeader('content-type', response.headers);\n      if (dest.setHeader) dest.setHeader(ctname, response.headers[ctname]);else dest.headers[ctname] = response.headers[ctname];\n    }\n    if (hasHeader('content-length', response.headers)) {\n      var clname = hasHeader('content-length', response.headers);\n      if (dest.setHeader) dest.setHeader(clname, response.headers[clname]);else dest.headers[clname] = response.headers[clname];\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      dest.setHeader(i, response.headers[i]);\n    }\n    dest.statusCode = response.statusCode;\n  }\n  if (this.pipefilter) this.pipefilter(response, dest);\n};\n\n// Composable API\nRequest.prototype.setHeader = function (name, value, clobber) {\n  if (clobber === undefined) clobber = true;\n  if (clobber || !this.hasHeader(name)) this.headers[name] = value;else this.headers[this.hasHeader(name)] += ',' + value;\n  return this;\n};\nRequest.prototype.setHeaders = function (headers) {\n  for (var i in headers) {\n    this.setHeader(i, headers[i]);\n  }\n  return this;\n};\nRequest.prototype.hasHeader = function (header, headers) {\n  var headers = Object.keys(headers || this.headers),\n    lheaders = headers.map(function (h) {\n      return h.toLowerCase();\n    });\n  header = header.toLowerCase();\n  for (var i = 0; i < lheaders.length; i++) {\n    if (lheaders[i] === header) return headers[i];\n  }\n  return false;\n};\nvar hasHeader = Request.prototype.hasHeader;\nRequest.prototype.qs = function (q, clobber) {\n  var base;\n  if (!clobber && this.uri.query) base = qs.parse(this.uri.query);else base = {};\n  for (var i in q) {\n    base[i] = q[i];\n  }\n  if (qs.stringify(base) === '') {\n    return this;\n  }\n  this.uri = url.parse(this.uri.href.split('?')[0] + '?' + qs.stringify(base));\n  this.url = this.uri;\n  this.path = this.uri.path;\n  return this;\n};\nRequest.prototype.form = function (form) {\n  if (form) {\n    this.setHeader('content-type', 'application/x-www-form-urlencoded; charset=utf-8');\n    this.body = qs.stringify(form).toString('utf8');\n    return this;\n  }\n  // create form-data object\n  this._form = new FormData();\n  return this._form;\n};\nRequest.prototype.multipart = function (multipart) {\n  var self = this;\n  self.body = [];\n  if (!self.hasHeader('content-type')) {\n    self.setHeader('content-type', 'multipart/related; boundary=' + self.boundary);\n  } else {\n    self.setHeader('content-type', self.headers['content-type'].split(';')[0] + '; boundary=' + self.boundary);\n  }\n  if (!multipart.forEach) throw new Error('Argument error, options.multipart.');\n  if (self.preambleCRLF) {\n    self.body.push(new Buffer('\\r\\n'));\n  }\n  multipart.forEach(function (part) {\n    var body = part.body;\n    if (body == null) throw Error('Body attribute missing in multipart.');\n    delete part.body;\n    var preamble = '--' + self.boundary + '\\r\\n';\n    Object.keys(part).forEach(function (key) {\n      preamble += key + ': ' + part[key] + '\\r\\n';\n    });\n    preamble += '\\r\\n';\n    self.body.push(new Buffer(preamble));\n    self.body.push(new Buffer(body));\n    self.body.push(new Buffer('\\r\\n'));\n  });\n  self.body.push(new Buffer('--' + self.boundary + '--'));\n  return self;\n};\nRequest.prototype.json = function (val) {\n  var self = this;\n  if (!self.hasHeader('accept')) self.setHeader('accept', 'application/json');\n  this._json = true;\n  if (typeof val === 'boolean') {\n    if (typeof this.body === 'object') {\n      this.body = safeStringify(this.body);\n      self.setHeader('content-type', 'application/json');\n    }\n  } else {\n    this.body = safeStringify(val);\n    self.setHeader('content-type', 'application/json');\n  }\n  return this;\n};\nRequest.prototype.getHeader = function (name, headers) {\n  var result, re, match;\n  if (!headers) headers = this.headers;\n  Object.keys(headers).forEach(function (key) {\n    re = new RegExp(name, 'i');\n    match = key.match(re);\n    if (match) result = headers[key];\n  });\n  return result;\n};\nvar getHeader = Request.prototype.getHeader;\nRequest.prototype.auth = function (user, pass, sendImmediately) {\n  if (typeof user !== 'string' || pass !== undefined && typeof pass !== 'string') {\n    throw new Error('auth() received invalid user or password');\n  }\n  this._user = user;\n  this._pass = pass;\n  this._hasAuth = true;\n  var header = typeof pass !== 'undefined' ? user + ':' + pass : user;\n  if (sendImmediately || typeof sendImmediately == 'undefined') {\n    this.setHeader('authorization', 'Basic ' + toBase64(header));\n    this._sentAuth = true;\n  }\n  return this;\n};\nRequest.prototype.aws = function (opts, now) {\n  if (!now) {\n    this._aws = opts;\n    return this;\n  }\n  var date = new Date();\n  this.setHeader('date', date.toUTCString());\n  var auth = {\n    key: opts.key,\n    secret: opts.secret,\n    verb: this.method.toUpperCase(),\n    date: date,\n    contentType: this.getHeader('content-type') || '',\n    md5: this.getHeader('content-md5') || '',\n    amazonHeaders: aws.canonicalizeHeaders(this.headers)\n  };\n  if (opts.bucket && this.path) {\n    auth.resource = '/' + opts.bucket + this.path;\n  } else if (opts.bucket && !this.path) {\n    auth.resource = '/' + opts.bucket;\n  } else if (!opts.bucket && this.path) {\n    auth.resource = this.path;\n  } else if (!opts.bucket && !this.path) {\n    auth.resource = '/';\n  }\n  auth.resource = aws.canonicalizeResource(auth.resource);\n  this.setHeader('authorization', aws.authorization(auth));\n  return this;\n};\nRequest.prototype.httpSignature = function (opts) {\n  var req = this;\n  httpSignature.signRequest({\n    getHeader: function (header) {\n      return getHeader(header, req.headers);\n    },\n    setHeader: function (header, value) {\n      req.setHeader(header, value);\n    },\n    method: this.method,\n    path: this.path\n  }, opts);\n  debug('httpSignature authorization', this.getHeader('authorization'));\n  return this;\n};\nRequest.prototype.hawk = function (opts) {\n  this.setHeader('Authorization', hawk.client.header(this.uri, this.method, opts).field);\n};\nRequest.prototype.oauth = function (_oauth) {\n  var form;\n  if (this.hasHeader('content-type') && this.getHeader('content-type').slice(0, 'application/x-www-form-urlencoded'.length) === 'application/x-www-form-urlencoded') {\n    form = qs.parse(this.body);\n  }\n  if (this.uri.query) {\n    form = qs.parse(this.uri.query);\n  }\n  if (!form) form = {};\n  var oa = {};\n  for (var i in form) oa[i] = form[i];\n  for (var i in _oauth) oa['oauth_' + i] = _oauth[i];\n  if (!oa.oauth_version) oa.oauth_version = '1.0';\n  if (!oa.oauth_timestamp) oa.oauth_timestamp = Math.floor(Date.now() / 1000).toString();\n  if (!oa.oauth_nonce) oa.oauth_nonce = uuid().replace(/-/g, '');\n  oa.oauth_signature_method = 'HMAC-SHA1';\n  var consumer_secret = oa.oauth_consumer_secret;\n  delete oa.oauth_consumer_secret;\n  var token_secret = oa.oauth_token_secret;\n  delete oa.oauth_token_secret;\n  var timestamp = oa.oauth_timestamp;\n  var baseurl = this.uri.protocol + '//' + this.uri.host + this.uri.pathname;\n  var signature = oauth.hmacsign(this.method, baseurl, oa, consumer_secret, token_secret);\n\n  // oa.oauth_signature = signature\n  for (var i in form) {\n    if (i.slice(0, 'oauth_') in _oauth) {\n      // skip\n    } else {\n      delete oa['oauth_' + i];\n      if (i !== 'x_auth_mode') delete oa[i];\n    }\n  }\n  oa.oauth_timestamp = timestamp;\n  var authHeader = 'OAuth ' + Object.keys(oa).sort().map(function (i) {\n    return i + '=\"' + oauth.rfc3986(oa[i]) + '\"';\n  }).join(',');\n  authHeader += ',oauth_signature=\"' + oauth.rfc3986(signature) + '\"';\n  this.setHeader('Authorization', authHeader);\n  return this;\n};\nRequest.prototype.jar = function (jar) {\n  var cookies;\n  if (this._redirectsFollowed === 0) {\n    this.originalCookieHeader = this.getHeader('cookie');\n  }\n  if (!jar) {\n    // disable cookies\n    cookies = false;\n    this._disableCookies = true;\n  } else if (jar && jar.get) {\n    // fetch cookie from the user defined cookie jar\n    cookies = jar.get({\n      url: this.uri.href\n    });\n  } else {\n    // fetch cookie from the global cookie jar\n    cookies = cookieJar.get({\n      url: this.uri.href\n    });\n  }\n  if (cookies && cookies.length) {\n    var cookieString = cookies.map(function (c) {\n      return c.name + \"=\" + c.value;\n    }).join(\"; \");\n    if (this.originalCookieHeader) {\n      // Don't overwrite existing Cookie header\n      this.setHeader('cookie', this.originalCookieHeader + '; ' + cookieString);\n    } else {\n      this.setHeader('cookie', cookieString);\n    }\n  }\n  this._jar = jar;\n  return this;\n};\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  if (this.response) {\n    if (this._destdata) {\n      throw new Error(\"You cannot pipe after data has been emitted from the response.\");\n    } else if (this._ended) {\n      throw new Error(\"You cannot pipe after the response has been ended.\");\n    } else {\n      stream.Stream.prototype.pipe.call(this, dest, opts);\n      this.pipeDest(dest);\n      return dest;\n    }\n  } else {\n    this.dests.push(dest);\n    stream.Stream.prototype.pipe.call(this, dest, opts);\n    return dest;\n  }\n};\nRequest.prototype.write = function () {\n  if (!this._started) this.start();\n  return this.req.write.apply(this.req, arguments);\n};\nRequest.prototype.end = function (chunk) {\n  if (chunk) this.write(chunk);\n  if (!this._started) this.start();\n  this.req.end();\n};\nRequest.prototype.pause = function () {\n  if (!this.response) this._paused = true;else this.response.pause.apply(this.response, arguments);\n};\nRequest.prototype.resume = function () {\n  if (!this.response) this._paused = false;else this.response.resume.apply(this.response, arguments);\n};\nRequest.prototype.destroy = function () {\n  if (!this._ended) this.end();else if (this.response) this.response.destroy();\n};\nfunction toJSON() {\n  return getSafe(this, '__' + ((1 + Math.random()) * 0x10000 | 0).toString(16));\n}\nRequest.prototype.toJSON = toJSON;\nmodule.exports = Request;","map":{"version":3,"names":["http","require","https","tls","url","util","stream","qs","querystring","crypto","oauth","hawk","aws","httpSignature","uuid","mime","tunnel","_safeStringify","ForeverAgent","FormData","Cookie","CookieJar","Jar","cookieJar","copy","debug","getSafe","safeStringify","obj","ret","JSON","stringify","e","globalPool","isUrl","Agent","options","call","inherits","prototype","_getConnection","host","port","cb","s","connect","isReadStream","rs","readable","path","mode","toBase64","str","Buffer","toString","md5","createHash","update","digest","Request","Stream","writable","uri","reserved","Object","keys","i","indexOf","method","explicitMethod","init","self","localAddress","pool","dests","__isRequestRequest","_callback","callback","_callbackCalled","apply","arguments","on","bind","emit","Error","parse","strictSSL","rejectUnauthorized","proxy","globalAgent","protocol","tunnelFn","httpsOverHttp","httpsOverHttps","tunnelOptions","hostname","proxyAuth","auth","headers","Host","ca","agent","pathname","faultyUri","format","message","length","_redirectsFollowed","maxRedirects","undefined","followRedirect","followAllRedirects","redirects","setHost","hasHeader","setHeader","getHeader","jar","_jar","clientErrorHandler","error","_aborted","req","_reusedSocket","code","addRequestNoreuse","addRequest","start","end","timeout","timeoutTimer","clearTimeout","_parserErrorHandler","res","request","_httpMessage","form","search","user","username","pass","password","sendImmediately","authPieces","split","map","item","unescape","slice","join","json","multipart","boundary","body","isBuffer","Array","isArray","defaultModules","httpModules","httpModule","agentOptions","agentClass","forever","SSL","getAgent","maxSockets","src","ntick","_started","lookup","_json","process","nextTick","_form","setHeaders","getHeaders","pipe","forEach","part","write","requestBodyStream","console","warn","_updateProtocol","cert","key","poolKey","name","isHttps","ciphers","secureOptions","href","stat","size","_aws","reqOptions","onResponse","setTimeout","abort","connection","removeListener","response","statusCode","listeners","once","resume","_paused","pause","toJSON","client","authorized","sslErr","authorizationError","addCookie","cookie","add","_disableCookies","headerName","redirectTo","location","_hasAuth","_sentAuth","authHeader","authVerb","_user","_pass","matches","match","challenge","eqPos","substring","quotedValue","ha1","realm","ha2","digestResponse","nonce","authValues","qop","nc","cnonce","k","push","test","resolve","uriPrev","redirectUri","_ended","encoding","setEncoding","dest","pipeDest","chunk","_destdata","buffer","bodyLen","headersSent","ctname","clname","pipefilter","value","clobber","header","lheaders","h","toLowerCase","q","base","query","preambleCRLF","preamble","val","result","re","RegExp","opts","now","date","Date","toUTCString","secret","verb","toUpperCase","contentType","amazonHeaders","canonicalizeHeaders","bucket","resource","canonicalizeResource","authorization","signRequest","field","_oauth","oa","oauth_version","oauth_timestamp","Math","floor","oauth_nonce","replace","oauth_signature_method","consumer_secret","oauth_consumer_secret","token_secret","oauth_token_secret","timestamp","baseurl","signature","hmacsign","sort","rfc3986","cookies","originalCookieHeader","get","cookieString","c","destroy","random","module","exports"],"sources":["/Users/jaraga/CodeOp/perthesclinica/node_modules/request/request.js"],"sourcesContent":["var http = require('http')\n  , https = false\n  , tls = false\n  , url = require('url')\n  , util = require('util')\n  , stream = require('stream')\n  , qs = require('qs')\n  , querystring = require('querystring')\n  , crypto = require('crypto')\n\n  , oauth = require('oauth-sign')\n  , hawk = require('hawk')\n  , aws = require('aws-sign')\n  , httpSignature = require('http-signature')\n  , uuid = require('node-uuid')\n  , mime = require('mime')\n  , tunnel = require('tunnel-agent')\n  , _safeStringify = require('json-stringify-safe')\n\n  , ForeverAgent = require('forever-agent')\n  , FormData = require('form-data')\n\n  , Cookie = require('cookie-jar')\n  , CookieJar = Cookie.Jar\n  , cookieJar = new CookieJar\n\n  , copy = require('./lib/copy')\n  , debug = require('./lib/debug')\n  , getSafe = require('./lib/getSafe')\n  ;\n\nfunction safeStringify (obj) {\n  var ret\n  try { ret = JSON.stringify(obj) }\n  catch (e) { ret = _safeStringify(obj) }\n  return ret\n}\n\nvar globalPool = {}\nvar isUrl = /^https?:/i\n\ntry {\n  https = require('https')\n} catch (e) {}\n\ntry {\n  tls = require('tls')\n} catch (e) {}\n\n\n\n// Hacky fix for pre-0.4.4 https\nif (https && !https.Agent) {\n  https.Agent = function (options) {\n    http.Agent.call(this, options)\n  }\n  util.inherits(https.Agent, http.Agent)\n  https.Agent.prototype._getConnection = function (host, port, cb) {\n    var s = tls.connect(port, host, this.options, function () {\n      // do other checks here?\n      if (cb) cb()\n    })\n    return s\n  }\n}\n\nfunction isReadStream (rs) {\n  if (rs.readable && rs.path && rs.mode) {\n    return true\n  }\n}\n\nfunction toBase64 (str) {\n  return (new Buffer(str || \"\", \"ascii\")).toString(\"base64\")\n}\n\nfunction md5 (str) {\n  return crypto.createHash('md5').update(str).digest('hex')\n}\n\nfunction Request (options) {\n  stream.Stream.call(this)\n  this.readable = true\n  this.writable = true\n\n  if (typeof options === 'string') {\n    options = {uri:options}\n  }\n\n  var reserved = Object.keys(Request.prototype)\n  for (var i in options) {\n    if (reserved.indexOf(i) === -1) {\n      this[i] = options[i]\n    } else {\n      if (typeof options[i] === 'function') {\n        delete options[i]\n      }\n    }\n  }\n\n  if (options.method) {\n    this.explicitMethod = true\n  }\n\n  this.init(options)\n}\nutil.inherits(Request, stream.Stream)\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this\n  if (!options) options = {}\n\n  if (!self.method) self.method = options.method || 'GET'\n  self.localAddress = options.localAddress\n\n  debug(options)\n  if (!self.pool && self.pool !== false) self.pool = globalPool\n  self.dests = self.dests || []\n  self.__isRequestRequest = true\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback\n    self.callback = function () {\n      if (self._callbackCalled) return // Print a warning maybe?\n      self._callbackCalled = true\n      self._callback.apply(self, arguments)\n    }\n    self.on('error', self.callback.bind())\n    self.on('complete', self.callback.bind(self, null))\n  }\n\n  if (self.url && !self.uri) {\n    // People use this property instead all the time so why not just support it.\n    self.uri = self.url\n    delete self.url\n  }\n\n  if (!self.uri) {\n    // this will throw if unhandled but is handleable when in a redirect\n    return self.emit('error', new Error(\"options.uri is a required argument\"))\n  } else {\n    if (typeof self.uri == \"string\") self.uri = url.parse(self.uri)\n  }\n\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false\n  }\n\n  if (self.proxy) {\n    if (typeof self.proxy == 'string') self.proxy = url.parse(self.proxy)\n\n    // do the HTTP CONNECT dance using koichik/node-tunnel\n    if (http.globalAgent && self.uri.protocol === \"https:\") {\n      var tunnelFn = self.proxy.protocol === \"http:\"\n                   ? tunnel.httpsOverHttp : tunnel.httpsOverHttps\n\n      var tunnelOptions = { proxy: { host: self.proxy.hostname\n                                   , port: +self.proxy.port\n                                   , proxyAuth: self.proxy.auth\n                                   , headers: { Host: self.uri.hostname + ':' +\n                                        (self.uri.port || self.uri.protocol === 'https:' ? 443 : 80) }}\n                          , rejectUnauthorized: self.rejectUnauthorized\n                          , ca: this.ca }\n\n      self.agent = tunnelFn(tunnelOptions)\n      self.tunnel = true\n    }\n  }\n\n  if (!self.uri.pathname) {self.uri.pathname = '/'}\n\n  if (!self.uri.host) {\n    // Invalid URI: it may generate lot of bad errors, like \"TypeError: Cannot call method 'indexOf' of undefined\" in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri)\n    var message = 'Invalid URI \"' + faultyUri + '\"'\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (he didn't call request directly with this URL)\n      // he should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.'\n    }\n    self.emit('error', new Error(message))\n    return // This error was fatal\n  }\n\n  self._redirectsFollowed = self._redirectsFollowed || 0\n  self.maxRedirects = (self.maxRedirects !== undefined) ? self.maxRedirects : 10\n  self.followRedirect = (self.followRedirect !== undefined) ? self.followRedirect : true\n  self.followAllRedirects = (self.followAllRedirects !== undefined) ? self.followAllRedirects : false\n  if (self.followRedirect || self.followAllRedirects)\n    self.redirects = self.redirects || []\n\n  self.headers = self.headers ? copy(self.headers) : {}\n\n  self.setHost = false\n  if (!self.hasHeader('host')) {\n    self.setHeader('host', self.uri.hostname)\n    if (self.uri.port) {\n      if ( !(self.uri.port === 80 && self.uri.protocol === 'http:') &&\n           !(self.uri.port === 443 && self.uri.protocol === 'https:') )\n      self.setHeader('host', self.getHeader('host') + (':'+self.uri.port) )\n    }\n    self.setHost = true\n  }\n\n  self.jar(self._jar || options.jar)\n\n  if (!self.uri.port) {\n    if (self.uri.protocol == 'http:') {self.uri.port = 80}\n    else if (self.uri.protocol == 'https:') {self.uri.port = 443}\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port\n    self.host = self.proxy.hostname\n  } else {\n    self.port = self.uri.port\n    self.host = self.uri.hostname\n  }\n\n  self.clientErrorHandler = function (error) {\n    if (self._aborted) return\n\n    if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET'\n        && self.agent.addRequestNoreuse) {\n      self.agent = { addRequest: self.agent.addRequestNoreuse.bind(self.agent) }\n      self.start()\n      self.req.end()\n      return\n    }\n    if (self.timeout && self.timeoutTimer) {\n      clearTimeout(self.timeoutTimer)\n      self.timeoutTimer = null\n    }\n    self.emit('error', error)\n  }\n\n  self._parserErrorHandler = function (error) {\n    if (this.res) {\n      if (this.res.request) {\n        this.res.request.emit('error', error)\n      } else {\n        this.res.emit('error', error)\n      }\n    } else {\n      this._httpMessage.emit('error', error)\n    }\n  }\n\n  if (options.form) {\n    self.form(options.form)\n  }\n\n  if (options.qs) self.qs(options.qs)\n\n  if (self.uri.path) {\n    self.path = self.uri.path\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || \"\")\n  }\n\n  if (self.path.length === 0) self.path = '/'\n\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.oauth) {\n    self.oauth(options.oauth)\n  }\n\n  if (options.aws) {\n    self.aws(options.aws)\n  }\n\n  if (options.hawk) {\n    self.hawk(options.hawk)\n  }\n\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature)\n  }\n\n  if (options.auth) {\n    self.auth(\n      (options.auth.user===\"\") ? options.auth.user : (options.auth.user || options.auth.username ),\n      options.auth.pass || options.auth.password,\n      options.auth.sendImmediately)\n  }\n\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var authPieces = self.uri.auth.split(':').map(function(item){ return querystring.unescape(item) })\n    self.auth(authPieces[0], authPieces.slice(1).join(':'), true)\n  }\n  if (self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization') && !self.tunnel) {\n    self.setHeader('proxy-authorization', \"Basic \" + toBase64(self.proxy.auth.split(':').map(function(item){ return querystring.unescape(item)}).join(':')))\n  }\n\n\n  if (self.proxy && !self.tunnel) self.path = (self.uri.protocol + '//' + self.uri.host + self.path)\n\n  if (options.json) {\n    self.json(options.json)\n  } else if (options.multipart) {\n    self.boundary = uuid()\n    self.multipart(options.multipart)\n  }\n\n  if (self.body) {\n    var length = 0\n    if (!Buffer.isBuffer(self.body)) {\n      if (Array.isArray(self.body)) {\n        for (var i = 0; i < self.body.length; i++) {\n          length += self.body[i].length\n        }\n      } else {\n        self.body = new Buffer(self.body)\n        length = self.body.length\n      }\n    } else {\n      length = self.body.length\n    }\n    if (length) {\n      if (!self.hasHeader('content-length')) self.setHeader('content-length', length)\n    } else {\n      throw new Error('Argument error, options.body.')\n    }\n  }\n\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol\n    , defaultModules = {'http:':http, 'https:':https}\n    , httpModules = self.httpModules || {}\n    ;\n  self.httpModule = httpModules[protocol] || defaultModules[protocol]\n\n  if (!self.httpModule) return this.emit('error', new Error(\"Invalid protocol\"))\n\n  if (options.ca) self.ca = options.ca\n\n  if (!self.agent) {\n    if (options.agentOptions) self.agentOptions = options.agentOptions\n\n    if (options.agentClass) {\n      self.agentClass = options.agentClass\n    } else if (options.forever) {\n      self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL\n    } else {\n      self.agentClass = self.httpModule.Agent\n    }\n  }\n\n  if (self.pool === false) {\n    self.agent = false\n  } else {\n    self.agent = self.agent || self.getAgent()\n    if (self.maxSockets) {\n      // Don't use our pooling if node has the refactored client\n      self.agent.maxSockets = self.maxSockets\n    }\n    if (self.pool.maxSockets) {\n      // Don't use our pooling if node has the refactored client\n      self.agent.maxSockets = self.pool.maxSockets\n    }\n  }\n\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) throw new Error(\"You cannot pipe to this stream after the outbound request has started.\")\n    self.src = src\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) self.setHeader('content-type', mime.lookup(src.path))\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i])\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type'))\n        self.setHeader('content-type', 'application/json')\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error(\"You have already piped to this stream. Pipeing twice is likely to break the request.\")\n    // })\n  })\n\n  process.nextTick(function () {\n    if (self._aborted) return\n\n    if (self._form) {\n      self.setHeaders(self._form.getHeaders())\n      self._form.pipe(self)\n    }\n    if (self.body) {\n      if (Array.isArray(self.body)) {\n        self.body.forEach(function (part) {\n          self.write(part)\n        })\n      } else {\n        self.write(self.body)\n      }\n      self.end()\n    } else if (self.requestBodyStream) {\n      console.warn(\"options.requestBodyStream is deprecated, please pass the request object to stream.pipe.\")\n      self.requestBodyStream.pipe(self)\n    } else if (!self.src) {\n      if (self.method !== 'GET' && typeof self.method !== 'undefined') {\n        self.setHeader('content-length', 0)\n      }\n      self.end()\n    }\n    self.ntick = true\n  })\n}\n\n// Must call this when following a redirect from https to http or vice versa\n// Attempts to keep everything as identical as possible, but update the\n// httpModule, Tunneling agent, and/or Forever Agent in use.\nRequest.prototype._updateProtocol = function () {\n  var self = this\n  var protocol = self.uri.protocol\n\n  if (protocol === 'https:') {\n    // previously was doing http, now doing https\n    // if it's https, then we might need to tunnel now.\n    if (self.proxy) {\n      self.tunnel = true\n      var tunnelFn = self.proxy.protocol === 'http:'\n                   ? tunnel.httpsOverHttp : tunnel.httpsOverHttps\n      var tunnelOptions = { proxy: { host: self.proxy.hostname\n                                   , port: +self.proxy.port\n                                   , proxyAuth: self.proxy.auth }\n                          , rejectUnauthorized: self.rejectUnauthorized\n                          , ca: self.ca }\n      self.agent = tunnelFn(tunnelOptions)\n      return\n    }\n\n    self.httpModule = https\n    switch (self.agentClass) {\n      case ForeverAgent:\n        self.agentClass = ForeverAgent.SSL\n        break\n      case http.Agent:\n        self.agentClass = https.Agent\n        break\n      default:\n        // nothing we can do.  Just hope for the best.\n        return\n    }\n\n    // if there's an agent, we need to get a new one.\n    if (self.agent) self.agent = self.getAgent()\n\n  } else {\n    // previously was doing https, now doing http\n    // stop any tunneling.\n    if (self.tunnel) self.tunnel = false\n    self.httpModule = http\n    switch (self.agentClass) {\n      case ForeverAgent.SSL:\n        self.agentClass = ForeverAgent\n        break\n      case https.Agent:\n        self.agentClass = http.Agent\n        break\n      default:\n        // nothing we can do.  just hope for the best\n        return\n    }\n\n    // if there's an agent, then get a new one.\n    if (self.agent) {\n      self.agent = null\n      self.agent = self.getAgent()\n    }\n  }\n}\n\nRequest.prototype.getAgent = function () {\n  var Agent = this.agentClass\n  var options = {}\n  if (this.agentOptions) {\n    for (var i in this.agentOptions) {\n      options[i] = this.agentOptions[i]\n    }\n  }\n  if (this.ca) options.ca = this.ca\n  if (typeof this.rejectUnauthorized !== 'undefined') options.rejectUnauthorized = this.rejectUnauthorized\n\n  if (this.cert && this.key) {\n    options.key = this.key\n    options.cert = this.cert\n  }\n\n  var poolKey = ''\n\n  // different types of agents are in different pools\n  if (Agent !== this.httpModule.Agent) {\n    poolKey += Agent.name\n  }\n\n  if (!this.httpModule.globalAgent) {\n    // node 0.4.x\n    options.host = this.host\n    options.port = this.port\n    if (poolKey) poolKey += ':'\n    poolKey += this.host + ':' + this.port\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = this.proxy\n  if (typeof proxy === 'string') proxy = url.parse(proxy)\n  var isHttps = (proxy && proxy.protocol === 'https:') || this.uri.protocol === 'https:'\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) poolKey += ':'\n      poolKey += options.ca\n    }\n\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) poolKey += ':'\n      poolKey += options.rejectUnauthorized\n    }\n\n    if (options.cert)\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii')\n\n    if (options.ciphers) {\n      if (poolKey) poolKey += ':'\n      poolKey += options.ciphers\n    }\n\n    if (options.secureOptions) {\n      if (poolKey) poolKey += ':'\n      poolKey += options.secureOptions\n    }\n  }\n\n  if (this.pool === globalPool && !poolKey && Object.keys(options).length === 0 && this.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return this.httpModule.globalAgent\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = this.uri.protocol + poolKey\n\n  // already generated an agent for this setting\n  if (this.pool[poolKey]) return this.pool[poolKey]\n\n  return this.pool[poolKey] = new Agent(options)\n}\n\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this\n\n  if (self._aborted) return\n\n  self._started = true\n  self.method = self.method || 'GET'\n  self.href = self.uri.href\n\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('content-length', self.src.stat.size)\n  }\n  if (self._aws) {\n    self.aws(self._aws, true)\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self)\n  delete reqOptions.auth\n\n  debug('make request', self.uri.href)\n  self.req = self.httpModule.request(reqOptions, self.onResponse.bind(self))\n\n  if (self.timeout && !self.timeoutTimer) {\n    self.timeoutTimer = setTimeout(function () {\n      self.req.abort()\n      var e = new Error(\"ETIMEDOUT\")\n      e.code = \"ETIMEDOUT\"\n      self.emit(\"error\", e)\n    }, self.timeout)\n\n    // Set additional timeout on socket - in case if remote\n    // server freeze after sending headers\n    if (self.req.setTimeout) { // only works on node 0.6+\n      self.req.setTimeout(self.timeout, function () {\n        if (self.req) {\n          self.req.abort()\n          var e = new Error(\"ESOCKETTIMEDOUT\")\n          e.code = \"ESOCKETTIMEDOUT\"\n          self.emit(\"error\", e)\n        }\n      })\n    }\n  }\n\n  self.req.on('error', self.clientErrorHandler)\n  self.req.on('drain', function() {\n    self.emit('drain')\n  })\n  self.on('end', function() {\n    if ( self.req.connection ) self.req.connection.removeListener('error', self._parserErrorHandler)\n  })\n  self.emit('request', self.req)\n}\nRequest.prototype.onResponse = function (response) {\n  var self = this\n  debug('onResponse', self.uri.href, response.statusCode, response.headers)\n  response.on('end', function() {\n    debug('response end', self.uri.href, response.statusCode, response.headers)\n  });\n\n  if (response.connection.listeners('error').indexOf(self._parserErrorHandler) === -1) {\n    response.connection.once('error', self._parserErrorHandler)\n  }\n  if (self._aborted) {\n    debug('aborted', self.uri.href)\n    response.resume()\n    return\n  }\n  if (self._paused) response.pause()\n  else response.resume()\n\n  self.response = response\n  response.request = self\n  response.toJSON = toJSON\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https &&\n      self.strictSSL &&\n      !response.client.authorized) {\n    debug('strict ssl error', self.uri.href)\n    var sslErr = response.client.authorizationError\n    self.emit('error', new Error('SSL Error: '+ sslErr))\n    return\n  }\n\n  if (self.setHost && self.hasHeader('host')) delete self.headers[self.hasHeader('host')]\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n\n  var addCookie = function (cookie) {\n    if (self._jar){\n      if(self._jar.add){\n        self._jar.add(new Cookie(cookie))\n      }\n      else cookieJar.add(new Cookie(cookie))\n    }\n\n  }\n\n  if (hasHeader('set-cookie', response.headers) && (!self._disableCookies)) {\n    var headerName = hasHeader('set-cookie', response.headers)\n    if (Array.isArray(response.headers[headerName])) response.headers[headerName].forEach(addCookie)\n    else addCookie(response.headers[headerName])\n  }\n\n  var redirectTo = null\n  if (response.statusCode >= 300 && response.statusCode < 400 && hasHeader('location', response.headers)) {\n    var location = response.headers[hasHeader('location', response.headers)]\n    debug('redirect', location)\n\n    if (self.followAllRedirects) {\n      redirectTo = location\n    } else if (self.followRedirect) {\n      switch (self.method) {\n        case 'PATCH':\n        case 'PUT':\n        case 'POST':\n        case 'DELETE':\n          // Do not follow redirects\n          break\n        default:\n          redirectTo = location\n          break\n      }\n    }\n  } else if (response.statusCode == 401 && self._hasAuth && !self._sentAuth) {\n    var authHeader = response.headers[hasHeader('www-authenticate', response.headers)]\n    var authVerb = authHeader && authHeader.split(' ')[0]\n    debug('reauth', authVerb)\n\n    switch (authVerb) {\n      case 'Basic':\n        self.auth(self._user, self._pass, true)\n        redirectTo = self.uri\n        break\n\n      case 'Digest':\n        // TODO: More complete implementation of RFC 2617.  For reference:\n        // http://tools.ietf.org/html/rfc2617#section-3\n        // https://github.com/bagder/curl/blob/master/lib/http_digest.c\n\n        var matches = authHeader.match(/([a-z0-9_-]+)=\"([^\"]+)\"/gi)\n        var challenge = {}\n\n        for (var i = 0; i < matches.length; i++) {\n          var eqPos = matches[i].indexOf('=')\n          var key = matches[i].substring(0, eqPos)\n          var quotedValue = matches[i].substring(eqPos + 1)\n          challenge[key] = quotedValue.substring(1, quotedValue.length - 1)\n        }\n\n        var ha1 = md5(self._user + ':' + challenge.realm + ':' + self._pass)\n        var ha2 = md5(self.method + ':' + self.uri.path)\n        var digestResponse = md5(ha1 + ':' + challenge.nonce + ':1::auth:' + ha2)\n        var authValues = {\n          username: self._user,\n          realm: challenge.realm,\n          nonce: challenge.nonce,\n          uri: self.uri.path,\n          qop: challenge.qop,\n          response: digestResponse,\n          nc: 1,\n          cnonce: ''\n        }\n\n        authHeader = []\n        for (var k in authValues) {\n          authHeader.push(k + '=\"' + authValues[k] + '\"')\n        }\n        authHeader = 'Digest ' + authHeader.join(', ')\n        self.setHeader('authorization', authHeader)\n        self._sentAuth = true\n\n        redirectTo = self.uri\n        break\n    }\n  }\n\n  if (redirectTo) {\n    debug('redirect to', redirectTo)\n\n    // ignore any potential response body.  it cannot possibly be useful\n    // to us at this point.\n    if (self._paused) response.resume()\n\n    if (self._redirectsFollowed >= self.maxRedirects) {\n      self.emit('error', new Error(\"Exceeded maxRedirects. Probably stuck in a redirect loop \"+self.uri.href))\n      return\n    }\n    self._redirectsFollowed += 1\n\n    if (!isUrl.test(redirectTo)) {\n      redirectTo = url.resolve(self.uri.href, redirectTo)\n    }\n\n    var uriPrev = self.uri\n    self.uri = url.parse(redirectTo)\n\n    // handle the case where we change protocol from https to http or vice versa\n    if (self.uri.protocol !== uriPrev.protocol) {\n      self._updateProtocol()\n    }\n\n    self.redirects.push(\n      { statusCode : response.statusCode\n      , redirectUri: redirectTo\n      }\n    )\n    if (self.followAllRedirects && response.statusCode != 401) self.method = 'GET'\n    // self.method = 'GET' // Force all redirects to use GET || commented out fixes #215\n    delete self.src\n    delete self.req\n    delete self.agent\n    delete self._started\n    if (response.statusCode != 401) {\n      // Remove parameters from the previous response, unless this is the second request\n      // for a server that requires digest authentication.\n      delete self.body\n      delete self._form\n      if (self.headers) {\n        if (self.hasHeader('host')) delete self.headers[self.hasHeader('host')]\n        if (self.hasHeader('content-type')) delete self.headers[self.hasHeader('content-type')]\n        if (self.hasHeader('content-length')) delete self.headers[self.hasHeader('content-length')]\n      }\n    }\n\n    self.emit('redirect');\n\n    self.init()\n    return // Ignore the rest of the response\n  } else {\n    self._redirectsFollowed = self._redirectsFollowed || 0\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.on('close', function () {\n      if (!self._ended) self.response.emit('end')\n    })\n\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error(\"Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.\")\n      } else {\n        response.setEncoding(self.encoding)\n      }\n    }\n\n    self.emit('response', response)\n\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest)\n    })\n\n    response.on(\"data\", function (chunk) {\n      self._destdata = true\n      self.emit(\"data\", chunk)\n    })\n    response.on(\"end\", function (chunk) {\n      self._ended = true\n      self.emit(\"end\", chunk)\n    })\n    response.on(\"close\", function () {self.emit(\"close\")})\n\n    if (self.callback) {\n      var buffer = []\n      var bodyLen = 0\n      self.on(\"data\", function (chunk) {\n        buffer.push(chunk)\n        bodyLen += chunk.length\n      })\n      self.on(\"end\", function () {\n        debug('end event', self.uri.href)\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n\n        if (buffer.length && Buffer.isBuffer(buffer[0])) {\n          debug('has body', self.uri.href, bodyLen)\n          var body = new Buffer(bodyLen)\n          var i = 0\n          buffer.forEach(function (chunk) {\n            chunk.copy(body, i, 0, chunk.length)\n            i += chunk.length\n          })\n          if (self.encoding === null) {\n            response.body = body\n          } else {\n            response.body = body.toString(self.encoding)\n          }\n        } else if (buffer.length) {\n          // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n          // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n          if (self.encoding === 'utf8' && buffer[0].length > 0 && buffer[0][0] === \"\\uFEFF\") {\n            buffer[0] = buffer[0].substring(1)\n          }\n          response.body = buffer.join('')\n        }\n\n        if (self._json) {\n          try {\n            response.body = JSON.parse(response.body)\n          } catch (e) {}\n        }\n        debug('emitting complete', self.uri.href)\n        if(response.body == undefined && !self._json) {\n          response.body = \"\";\n        }\n        self.emit('complete', response, response.body)\n      })\n    }\n    //if no callback\n    else{\n      self.on(\"end\", function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n        self.emit('complete', response);\n      });\n    }\n  }\n  debug('finish init function', self.uri.href)\n}\n\nRequest.prototype.abort = function () {\n  this._aborted = true\n\n  if (this.req) {\n    this.req.abort()\n  }\n  else if (this.response) {\n    this.response.abort()\n  }\n\n  this.emit(\"abort\")\n}\n\nRequest.prototype.pipeDest = function (dest) {\n  var response = this.response\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (hasHeader('content-type', response.headers)) {\n      var ctname = hasHeader('content-type', response.headers)\n      if (dest.setHeader) dest.setHeader(ctname, response.headers[ctname])\n      else dest.headers[ctname] = response.headers[ctname]\n    }\n\n    if (hasHeader('content-length', response.headers)) {\n      var clname = hasHeader('content-length', response.headers)\n      if (dest.setHeader) dest.setHeader(clname, response.headers[clname])\n      else dest.headers[clname] = response.headers[clname]\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      dest.setHeader(i, response.headers[i])\n    }\n    dest.statusCode = response.statusCode\n  }\n  if (this.pipefilter) this.pipefilter(response, dest)\n}\n\n// Composable API\nRequest.prototype.setHeader = function (name, value, clobber) {\n  if (clobber === undefined) clobber = true\n  if (clobber || !this.hasHeader(name)) this.headers[name] = value\n  else this.headers[this.hasHeader(name)] += ',' + value\n  return this\n}\nRequest.prototype.setHeaders = function (headers) {\n  for (var i in headers) {this.setHeader(i, headers[i])}\n  return this\n}\nRequest.prototype.hasHeader = function (header, headers) {\n  var headers = Object.keys(headers || this.headers)\n    , lheaders = headers.map(function (h) {return h.toLowerCase()})\n    ;\n  header = header.toLowerCase()\n  for (var i=0;i<lheaders.length;i++) {\n    if (lheaders[i] === header) return headers[i]\n  }\n  return false\n}\n\nvar hasHeader = Request.prototype.hasHeader\n\nRequest.prototype.qs = function (q, clobber) {\n  var base\n  if (!clobber && this.uri.query) base = qs.parse(this.uri.query)\n  else base = {}\n\n  for (var i in q) {\n    base[i] = q[i]\n  }\n\n  if (qs.stringify(base) === ''){\n    return this\n  }\n\n  this.uri = url.parse(this.uri.href.split('?')[0] + '?' + qs.stringify(base))\n  this.url = this.uri\n  this.path = this.uri.path\n\n  return this\n}\nRequest.prototype.form = function (form) {\n  if (form) {\n    this.setHeader('content-type', 'application/x-www-form-urlencoded; charset=utf-8')\n    this.body = qs.stringify(form).toString('utf8')\n    return this\n  }\n  // create form-data object\n  this._form = new FormData()\n  return this._form\n}\nRequest.prototype.multipart = function (multipart) {\n  var self = this\n  self.body = []\n\n  if (!self.hasHeader('content-type')) {\n    self.setHeader('content-type', 'multipart/related; boundary=' + self.boundary)\n  } else {\n    self.setHeader('content-type', self.headers['content-type'].split(';')[0] + '; boundary=' + self.boundary)\n  }\n\n  if (!multipart.forEach) throw new Error('Argument error, options.multipart.')\n\n  if (self.preambleCRLF) {\n    self.body.push(new Buffer('\\r\\n'))\n  }\n\n  multipart.forEach(function (part) {\n    var body = part.body\n    if(body == null) throw Error('Body attribute missing in multipart.')\n    delete part.body\n    var preamble = '--' + self.boundary + '\\r\\n'\n    Object.keys(part).forEach(function (key) {\n      preamble += key + ': ' + part[key] + '\\r\\n'\n    })\n    preamble += '\\r\\n'\n    self.body.push(new Buffer(preamble))\n    self.body.push(new Buffer(body))\n    self.body.push(new Buffer('\\r\\n'))\n  })\n  self.body.push(new Buffer('--' + self.boundary + '--'))\n  return self\n}\nRequest.prototype.json = function (val) {\n  var self = this\n\n  if (!self.hasHeader('accept')) self.setHeader('accept', 'application/json')\n\n  this._json = true\n  if (typeof val === 'boolean') {\n    if (typeof this.body === 'object') {\n      this.body = safeStringify(this.body)\n      self.setHeader('content-type', 'application/json')\n    }\n  } else {\n    this.body = safeStringify(val)\n    self.setHeader('content-type', 'application/json')\n  }\n  return this\n}\nRequest.prototype.getHeader = function (name, headers) {\n  var result, re, match\n  if (!headers) headers = this.headers\n  Object.keys(headers).forEach(function (key) {\n    re = new RegExp(name, 'i')\n    match = key.match(re)\n    if (match) result = headers[key]\n  })\n  return result\n}\nvar getHeader = Request.prototype.getHeader\n\nRequest.prototype.auth = function (user, pass, sendImmediately) {\n  if (typeof user !== 'string' || (pass !== undefined && typeof pass !== 'string')) {\n    throw new Error('auth() received invalid user or password')\n  }\n  this._user = user\n  this._pass = pass\n  this._hasAuth = true\n  var header = typeof pass !== 'undefined' ? user + ':' + pass : user\n  if (sendImmediately || typeof sendImmediately == 'undefined') {\n    this.setHeader('authorization', 'Basic ' + toBase64(header))\n    this._sentAuth = true\n  }\n  return this\n}\nRequest.prototype.aws = function (opts, now) {\n  if (!now) {\n    this._aws = opts\n    return this\n  }\n  var date = new Date()\n  this.setHeader('date', date.toUTCString())\n  var auth =\n    { key: opts.key\n    , secret: opts.secret\n    , verb: this.method.toUpperCase()\n    , date: date\n    , contentType: this.getHeader('content-type') || ''\n    , md5: this.getHeader('content-md5') || ''\n    , amazonHeaders: aws.canonicalizeHeaders(this.headers)\n    }\n  if (opts.bucket && this.path) {\n    auth.resource = '/' + opts.bucket + this.path\n  } else if (opts.bucket && !this.path) {\n    auth.resource = '/' + opts.bucket\n  } else if (!opts.bucket && this.path) {\n    auth.resource = this.path\n  } else if (!opts.bucket && !this.path) {\n    auth.resource = '/'\n  }\n  auth.resource = aws.canonicalizeResource(auth.resource)\n  this.setHeader('authorization', aws.authorization(auth))\n\n  return this\n}\nRequest.prototype.httpSignature = function (opts) {\n  var req = this\n  httpSignature.signRequest({\n    getHeader: function(header) {\n      return getHeader(header, req.headers)\n    },\n    setHeader: function(header, value) {\n      req.setHeader(header, value)\n    },\n    method: this.method,\n    path: this.path\n  }, opts)\n  debug('httpSignature authorization', this.getHeader('authorization'))\n\n  return this\n}\n\nRequest.prototype.hawk = function (opts) {\n  this.setHeader('Authorization', hawk.client.header(this.uri, this.method, opts).field)\n}\n\nRequest.prototype.oauth = function (_oauth) {\n  var form\n  if (this.hasHeader('content-type') &&\n      this.getHeader('content-type').slice(0, 'application/x-www-form-urlencoded'.length) ===\n        'application/x-www-form-urlencoded'\n     ) {\n    form = qs.parse(this.body)\n  }\n  if (this.uri.query) {\n    form = qs.parse(this.uri.query)\n  }\n  if (!form) form = {}\n  var oa = {}\n  for (var i in form) oa[i] = form[i]\n  for (var i in _oauth) oa['oauth_'+i] = _oauth[i]\n  if (!oa.oauth_version) oa.oauth_version = '1.0'\n  if (!oa.oauth_timestamp) oa.oauth_timestamp = Math.floor( Date.now() / 1000 ).toString()\n  if (!oa.oauth_nonce) oa.oauth_nonce = uuid().replace(/-/g, '')\n\n  oa.oauth_signature_method = 'HMAC-SHA1'\n\n  var consumer_secret = oa.oauth_consumer_secret\n  delete oa.oauth_consumer_secret\n  var token_secret = oa.oauth_token_secret\n  delete oa.oauth_token_secret\n  var timestamp = oa.oauth_timestamp\n\n  var baseurl = this.uri.protocol + '//' + this.uri.host + this.uri.pathname\n  var signature = oauth.hmacsign(this.method, baseurl, oa, consumer_secret, token_secret)\n\n  // oa.oauth_signature = signature\n  for (var i in form) {\n    if ( i.slice(0, 'oauth_') in _oauth) {\n      // skip\n    } else {\n      delete oa['oauth_'+i]\n      if (i !== 'x_auth_mode') delete oa[i]\n    }\n  }\n  oa.oauth_timestamp = timestamp\n  var authHeader = 'OAuth '+Object.keys(oa).sort().map(function (i) {return i+'=\"'+oauth.rfc3986(oa[i])+'\"'}).join(',')\n  authHeader += ',oauth_signature=\"' + oauth.rfc3986(signature) + '\"'\n  this.setHeader('Authorization', authHeader)\n  return this\n}\nRequest.prototype.jar = function (jar) {\n  var cookies\n\n  if (this._redirectsFollowed === 0) {\n    this.originalCookieHeader = this.getHeader('cookie')\n  }\n\n  if (!jar) {\n    // disable cookies\n    cookies = false\n    this._disableCookies = true\n  } else if (jar && jar.get) {\n    // fetch cookie from the user defined cookie jar\n    cookies = jar.get({ url: this.uri.href })\n  } else {\n    // fetch cookie from the global cookie jar\n    cookies = cookieJar.get({ url: this.uri.href })\n  }\n\n  if (cookies && cookies.length) {\n    var cookieString = cookies.map(function (c) {\n      return c.name + \"=\" + c.value\n    }).join(\"; \")\n\n    if (this.originalCookieHeader) {\n      // Don't overwrite existing Cookie header\n      this.setHeader('cookie', this.originalCookieHeader + '; ' + cookieString)\n    } else {\n      this.setHeader('cookie', cookieString)\n    }\n  }\n  this._jar = jar\n  return this\n}\n\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  if (this.response) {\n    if (this._destdata) {\n      throw new Error(\"You cannot pipe after data has been emitted from the response.\")\n    } else if (this._ended) {\n      throw new Error(\"You cannot pipe after the response has been ended.\")\n    } else {\n      stream.Stream.prototype.pipe.call(this, dest, opts)\n      this.pipeDest(dest)\n      return dest\n    }\n  } else {\n    this.dests.push(dest)\n    stream.Stream.prototype.pipe.call(this, dest, opts)\n    return dest\n  }\n}\nRequest.prototype.write = function () {\n  if (!this._started) this.start()\n  return this.req.write.apply(this.req, arguments)\n}\nRequest.prototype.end = function (chunk) {\n  if (chunk) this.write(chunk)\n  if (!this._started) this.start()\n  this.req.end()\n}\nRequest.prototype.pause = function () {\n  if (!this.response) this._paused = true\n  else this.response.pause.apply(this.response, arguments)\n}\nRequest.prototype.resume = function () {\n  if (!this.response) this._paused = false\n  else this.response.resume.apply(this.response, arguments)\n}\nRequest.prototype.destroy = function () {\n  if (!this._ended) this.end()\n  else if (this.response) this.response.destroy()\n}\n\nfunction toJSON () {\n  return getSafe(this, '__' + (((1+Math.random())*0x10000)|0).toString(16))\n}\n\nRequest.prototype.toJSON = toJSON\n\n\nmodule.exports = Request"],"mappings":"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"},"metadata":{},"sourceType":"script"}